define(["jquery"],function(t){return new Class({Implements:[Events,Options],initialize:function(t,e){this.setOptions(e);var i,n,s;i=this.options.values,n=this.options.labels,s=this.options.exists,this.options.canSurvey&&this.createEvents(i,n,s,0)},createEvents:function(t,e,n,s){for(i=0;i<t.length;i++){document.getElements("."+t[i]).each(i=>{var n=i.getAttribute("class"),a=i.getAttribute("id");0!==s&&s!==a||i.addEvent("click",s=>{s.stop(),i.getAttribute("style")?this.doAjax(i,n,t,e,a,1):this.doAjax(i,n,t,e,a,0)})})}},encode:function(t){var e=0,i=[];for(e=0;e<t.length;e++)i[e]=encodeURIComponent(t[e]);return i},doAjax:function(t,e,i,n,s,a){var r=t.getParent();Fabrik.loader.start(r);var o={option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"survey",method:"ajax_rate",g:"element",value:e,values:i,labels:n,rowId:s,exists:a,table_name:this.options.table_name,element_name:this.options.element_name,elementname:this.options.elid,userid:this.options.userid,listid:this.options.listid,formid:this.options.formid};new Request({url:"",data:o,onComplete:(s=>{Fabrik.loader.stop(r),s=JSON.parse(s),this.updateElements(t,i,n,s,e,a)}).bind(this)}).send()},updateElements:function(t,e,i,n,s,a){var r=t.getParent(),o=t.getAttribute("id");if(r)for(var l=r.firstChild;l;)r.removeChild(l),l=r.firstChild;for(var d=document.createElement("a"),u=document.createElement("span"),m=0;e[m];)d.setAttribute("href","#void"),d.setAttribute("class",e[m]),d.setAttribute("id",o),d.setAttribute("name",s+o),d.innerHTML=i[m]+" (",u.setAttribute("class","valueItem"),u.innerHTML=n[m],d.appendChild(u),u.insertAdjacentHTML("afterend",")"),r&&(r.appendChild(d),r.innerHTML+="<br>"),m++;1!==a&&r.getElementsByClassName(s)[0].setAttribute("style","text-decoration: underline;");this.createEvents(e,i,a,o)}})});